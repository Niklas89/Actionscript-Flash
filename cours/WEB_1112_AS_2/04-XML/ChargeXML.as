package {	import flash.display.MovieClip;	import flash.display.Sprite;	import flash.display.SimpleButton;	// package d'échange de données	import flash.net.navigateToURL;	import flash.net.URLLoader;	import flash.net.URLRequest;	import flash.net.URLLoaderDataFormat;	import flash.events.Event;	import flash.events.MouseEvent;	import flash.events.ProgressEvent;	import flash.events.IOErrorEvent;		import com.lionelUtils.DessineRectangle;	public class ChargeXML extends MovieClip	{		public var monXML		:XML;		public var navigation	:Sprite;		public function ChargeXML(){			monBouton.addEventListener(MouseEvent.CLICK, onURL);			monTexte.text = "Ici le contenu XML chargé : \n";		}				private function onURL(e:MouseEvent):void{				monBouton.removeEventListener(MouseEvent.CLICK, onURL);				//navigateToURL(new URLRequest(monURL));				chargeXML("personnes.xml");		}		public function chargeXML(u:String):void		{			// URLLoader permet de définir le fichier à charger			var chargeur	:URLLoader 	= new URLLoader();			// avec URLLoader nous pouvons charger des données de type			// texte, binaire, variables			// Ici nous choisissons le format TEXT			var format		:String 	= URLLoaderDataFormat.TEXT;			// et l'appliquons au à chargeur			chargeur.dataFormat 		= format;			chargeur.load(new URLRequest(u));			// ecoutons les différents evenements;			chargeur.addEventListener(Event.COMPLETE, finChargement);			chargeur.addEventListener(ProgressEvent.PROGRESS, onProgress);			chargeur.addEventListener(IOErrorEvent.IO_ERROR, onErreur);		}		private function finChargement(e:Event):void		{			monXML						= new XML(e.target.data);			monTexte.appendText(monXML.toString());			initNavigation();		}		private function initNavigation():void {			// instance du sprite ou se trouveront les boutons			navigation 								= new Sprite();			// ecoute le clic sur ce sprite			navigation.addEventListener(MouseEvent.CLICK, onClick);			// j'ajoute le sprite à la liste d'affichage			this.addChild(navigation);			// boucle qui créer la barre de navigation			for each(var pers:XML in monXML..user){				var monBoutton			:SimpleButton 		= createBouton(pers.@pseudo);				monBoutton.name								= pers.url;				monBoutton.x 								= navigation.width > 0 ? navigation.width + 30 : 0;				navigation.addChild(monBoutton);			}						function onClick(e:MouseEvent):void{				var _tempBouton			:SimpleButton		= e.target as SimpleButton;				trace("l'url du user est : " + _tempBouton.name);			}						navigation.x 							= (stage.stageWidth - navigation.width) /2;			navigation.y 							= stage.stageHeight - navigation.height - 10;		}				private function createBouton(monLabel:String = "Mon Bouton"):SimpleButton {			var simpleButton	:SimpleButton 		= new SimpleButton();			simpleButton.upState					= new DessineRectangle(0xFF0000,monLabel);			simpleButton.overState					= new DessineRectangle(0x00FF00,monLabel);			simpleButton.downState					= new DessineRectangle(0x0000FF,monLabel);			simpleButton.hitTestState				= new DessineRectangle(0xFF0000,monLabel);			simpleButton.useHandCursor				= true;			return simpleButton;		}						private function onProgress(e:ProgressEvent):void		{			trace(e.bytesLoaded + "charges sur : " + e.bytesTotal);		}		private function onErreur(e:Event):void		{			trace("Erreur au chargement : ",e);		}	}}